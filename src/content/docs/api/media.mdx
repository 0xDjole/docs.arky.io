---
title: Media API
description: File uploads, media library, and image transformations
head: []
---

import Tabs from '../../../components/Tabs.svelte';

Manage media uploads, transformations, and the media library. Files are stored in S3 with automatic image optimization.

## Base URL

All Media endpoints are prefixed with `/v1/businesses/{businessId}`.

## Authentication

Requires `Authorization: Bearer <access_token>` header with `WRITE` permissions.

---

## Upload Media

Upload files from local device or fetch from URLs.

**Endpoint:** `POST /v1/businesses/{businessId}/upload`

**Content-Type:** `multipart/form-data`

<Tabs client:load>
  <div slot="tab1">

```typescript
// Upload local files
const fileInput = document.querySelector('input[type="file"]');
const files = Array.from(fileInput.files);

const media = await sdk.media.uploadBusinessMedia({
  files: files,
  urls: [], // Optional: fetch from URLs
});

console.log('Uploaded:', media.length, 'files');
media.forEach((item) => {
  console.log('ID:', item.id);
  console.log('URL:', item.resolutions.original.url);
  console.log('Size:', item.size, 'bytes');
});
```

  </div>
  <div slot="tab2">

```bash
# Upload local file
curl -X POST https://api.arky.io/v1/businesses/YOUR_BUSINESS_ID/upload \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "files=@/path/to/image.jpg" \
  -F "files=@/path/to/document.pdf"

# Fetch from URL
curl -X POST https://api.arky.io/v1/businesses/YOUR_BUSINESS_ID/upload \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "files=https://example.com/image.jpg"
```

  </div>
</Tabs>

**Response:**

```json
[
  {
    "id": "media_abc123",
    "businessId": "biz_123",
    "name": "product-photo.jpg",
    "mimeType": "image/jpeg",
    "size": 245678,
    "resolutions": {
      "original": {
        "url": "https://storage.arky.io/original/abc123.jpg",
        "width": 2000,
        "height": 1500
      },
      "large": {
        "url": "https://storage.arky.io/large/abc123.jpg",
        "width": 1024,
        "height": 768
      },
      "medium": {
        "url": "https://storage.arky.io/medium/abc123.jpg",
        "width": 512,
        "height": 384
      },
      "small": {
        "url": "https://storage.arky.io/small/abc123.jpg",
        "width": 256,
        "height": 192
      }
    },
    "createdAt": 1698765432
  }
]
```

---

## Get Media Library

List all media files with pagination.

**Endpoint:** `GET /v1/businesses/{businessId}/media`

<Tabs client:load>
  <div slot="tab1">

```typescript
const { data, cursor } = await sdk.media.getBusinessMedia({
  limit: 20,
  cursor: null, // or cursor from previous response
});

console.log('Media items:', data.length);
console.log('Next cursor:', cursor);
```

  </div>
  <div slot="tab2">

```bash
curl "https://api.arky.io/v1/businesses/YOUR_BUSINESS_ID/media?limit=20" \
  -H "Authorization: Bearer YOUR_TOKEN"

# With cursor for pagination
curl "https://api.arky.io/v1/businesses/YOUR_BUSINESS_ID/media?limit=20&cursor=CURSOR_VALUE" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

  </div>
</Tabs>

**Response:**

```json
{
  "data": [
    {
      "id": "media_123",
      "businessId": "biz_abc",
      "name": "product-photo.jpg",
      "mimeType": "image/jpeg",
      "size": 245678,
      "resolutions": {...},
      "createdAt": 1698765432
    }
  ],
  "cursor": "next_page_cursor_xyz"
}
```

---

## Delete Media

Remove media from the library and storage.

**Endpoint:** `DELETE /v1/businesses/{businessId}/upload?mediaId=...`

<Tabs client:load>
  <div slot="tab1">

```typescript
await sdk.media.deleteBusinessMedia({
  id: 'biz_abc123',
  mediaId: 'media_xyz789',
});
```

  </div>
  <div slot="tab2">

```bash
curl -X DELETE "https://api.arky.io/v1/businesses/YOUR_BUSINESS_ID/upload?mediaId=MEDIA_ID" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

  </div>
</Tabs>

---

## Image Resolutions

Images are automatically resized to multiple resolutions:

| Resolution | Max Width | Max Height | Use Case |
|------------|-----------|------------|----------|
| **original** | Unchanged | Unchanged | High-res downloads, zoom |
| **large** | 1024px | 768px | Desktop displays |
| **medium** | 512px | 384px | Mobile displays |
| **small** | 256px | 192px | Thumbnails, lists |

**Aspect Ratio:** Preserved in all resolutions

**Format:** Images are served as WebP when supported by browser (automatic content negotiation)

---

## Supported File Types

### Images
- JPEG (`.jpg`, `.jpeg`)
- PNG (`.png`)
- GIF (`.gif`)
- WebP (`.webp`)
- SVG (`.svg`)

### Documents
- PDF (`.pdf`)

### Video
- MP4 (`.mp4`)
- WebM (`.webm`)

**Max File Size:** 10MB per file (configurable)

---

## Using Media in Content

### In Products

```typescript
const product = await sdk.eshop.createProduct({
  name: 'T-Shirt',
  gallery: [
    {
      id: 'media_abc123',
      url: 'https://storage.arky.io/large/abc123.jpg',
      mimeType: 'image/jpeg',
    },
  ],
  variants: [...],
});
```

### In CMS Entries

```typescript
const entry = await sdk.cms.createCollectionEntry({
  collectionId: 'blog_posts',
  blocks: [
    {
      id: 'featured_image',
      type: 'MEDIA',
      value: {
        id: 'media_abc123',
        url: 'https://storage.arky.io/large/abc123.jpg',
        mimeType: 'image/jpeg',
      },
    },
  ],
});
```

### In Business Gallery

```typescript
const business = await sdk.business.updateBusiness({
  gallery: [
    {
      id: 'media_abc123',
      url: 'https://storage.arky.io/large/abc123.jpg',
      mimeType: 'image/jpeg',
    },
  ],
});
```

---

## S3 Storage

Media files are stored in S3-compatible object storage:

**Storage Structure:**
```
bucket/
├── original/
│   └── {mediaId}.{ext}
├── large/
│   └── {mediaId}.jpg
├── medium/
│   └── {mediaId}.jpg
└── small/
    └── {mediaId}.jpg
```

**CDN:** All URLs are served through a CDN for optimal performance

**Expiry:** Original files are retained indefinitely; unused media can be manually deleted

---

## Best Practices

### 1. Upload Before Saving

Upload media first, then reference in products/entries:

```typescript
// 1. Upload
const [media] = await sdk.media.uploadBusinessMedia({
  files: [imageFile],
});

// 2. Use in product
const product = await sdk.eshop.createProduct({
  gallery: [media],
  ...
});
```

### 2. Use Appropriate Resolution

Choose resolution based on display context:

```typescript
// Thumbnail in list
<img src={media.resolutions.small.url} />

// Product detail page
<img src={media.resolutions.large.url} />

// Lightbox / zoom
<img src={media.resolutions.original.url} />
```

### 3. Lazy Loading

Use lazy loading for better performance:

```html
<img 
  src={media.resolutions.medium.url}
  loading="lazy"
  alt="Product image"
/>
```

### 4. Responsive Images

Use `srcset` for responsive images:

```html
<img 
  srcset="
    ${media.resolutions.small.url} 256w,
    ${media.resolutions.medium.url} 512w,
    ${media.resolutions.large.url} 1024w
  "
  sizes="(max-width: 600px) 256px, (max-width: 1200px) 512px, 1024px"
  src={media.resolutions.medium.url}
  alt="Product"
/>
```

---

## Related

- **[Business API: Media Management](/api/business/#media-management)**
- **[CMS API: Collections](/api/cms/#collections)**: Media in content
- **[E-shop API: Products](/api/eshop/#products)**: Product galleries
